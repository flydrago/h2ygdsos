<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.h2y.os.dao.read.ISpiritRoomGoodsRtDaoR">

	<resultMap type="com.h2y.os.entity.SpiritRoomGoodsRt" id="spiritroomgoodsrtDaoMap">
		<result property="id" column="id" javaType="long" jdbcType="BIGINT" />
		<result property="roomCode" column="room_code" javaType="string" jdbcType="VARCHAR" />
		<result property="unitId" column="unit_id" javaType="long" jdbcType="BIGINT" />
		<result property="unitType" column="unit_type" javaType="int" jdbcType="INTEGER" />
		<result property="zoneCode" column="zone_code" javaType="string" jdbcType="VARCHAR" />
		<result property="goodsNickName" column="goods_nick_name" javaType="string" jdbcType="VARCHAR" />
		<result property="goodsPriceId" column="goods_price_id" javaType="long" jdbcType="BIGINT" />
		<result property="goodsId" column="goods_id" javaType="long" jdbcType="BIGINT" />
		<result property="goodsCount" column="goods_count" javaType="int" jdbcType="INTEGER" />
		<result property="goodsAmount" column="goods_amount" javaType="double" jdbcType="DOUBLE" />
		<result property="createDate" column="create_date" javaType="date" jdbcType="TIMESTAMP" />
		<result property="updateDate" column="update_date" javaType="date" jdbcType="TIMESTAMP" />
	</resultMap>
	

	<select id="get" parameterType="long"
		resultMap="spiritroomgoodsrtDaoMap">
		select * from tb_spirit_room_goods_rt where id = #{id}
	</select>
	
	<select id="getByGoodsPriceId" parameterType="hashmap"
		resultMap="spiritroomgoodsrtDaoMap">
		select * from tb_spirit_room_goods_rt where room_code = #{roomCode} and goods_price_id = #{goodsPriceId}
	</select>
	
	
	
	
	<select id="getGoodsRowsByZoneCode" parameterType="hashmap"
		resultType="long">
		select count(id) from tb_spirit_room_goods_rt 
		where room_code = #{roomCode} 
		and (zone_code like '${zoneCode}%' and unit_type = 1) or (zone_code = '${zoneCode}' and unit_type = 0) 
	</select>
	
	<select id="getByGoodsPriceIdAndAccount" parameterType="hashmap"
		resultMap="spiritroomgoodsrtDaoMap">
		select * from tb_spirit_room_goods_rt where room_code in (select sr.room_code from tb_spirit_room sr where sr.account = #{account}) and goods_price_id = #{goodsPriceId}
	</select>
	
</mapper>