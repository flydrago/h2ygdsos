<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.h2y.os.dao.read.IShareHrefDaoR">

	<resultMap type="com.h2y.os.entity.ShareHref" id="sharehrefDaoMap">
		<result property="id" column="id" javaType="long" jdbcType="BIGINT" />
		<result property="unitId" column="unit_id" javaType="long" jdbcType="BIGINT" />
		<result property="unitType" column="unit_type" javaType="int" jdbcType="INTEGER" />
		<result property="zoneCode" column="zone_code" javaType="string" jdbcType="VARCHAR" />
		<result property="name" column="name" javaType="string" jdbcType="VARCHAR" />
		<result property="createDate" column="create_date" javaType="date" jdbcType="TIMESTAMP" />
		<result property="updateDate" column="update_date" javaType="date" jdbcType="TIMESTAMP" />
		<result property="title" column="title" javaType="string" jdbcType="VARCHAR" />
		<result property="description" column="description" javaType="string" jdbcType="VARCHAR" />
		<result property="fileName" column="file_name" javaType="string" jdbcType="VARCHAR" />
		<result property="diskFileName" column="disk_file_name" javaType="string" jdbcType="VARCHAR" />
		<result property="rootPath" column="root_path" javaType="string" jdbcType="VARCHAR" />
		<result property="relativePath" column="relative_path" javaType="string" jdbcType="VARCHAR" />
		<result property="fileSize" column="file_size" javaType="long" jdbcType="BIGINT" />
		<result property="fileSuffix" column="file_suffix" javaType="string" jdbcType="VARCHAR" />
		<result property="dataType" column="data_type" javaType="string" jdbcType="VARCHAR" />
		<result property="str1" column="str_1" javaType="string" jdbcType="VARCHAR" />
		<result property="str2" column="str_2" javaType="string" jdbcType="VARCHAR" />
		<result property="str3" column="str_3" javaType="string" jdbcType="VARCHAR" />
		<result property="ord" column="ord" javaType="int" jdbcType="INTEGER" />
		<result property="hrefStatus" column="href_status" javaType="int" jdbcType="INTEGER" />
	</resultMap>
	
	<resultMap type="com.h2y.os.entity.VoteSubject" id="votesubjectDaoMap">
		<result property="id" column="id" javaType="long" jdbcType="BIGINT" />
		<result property="unitId" column="unit_id" javaType="long" jdbcType="BIGINT" />
		<result property="unitType" column="unit_type" javaType="int" jdbcType="INTEGER" />
		<result property="zoneCode" column="zone_code" javaType="string" jdbcType="VARCHAR" />
		<result property="subjectName" column="subject_name" javaType="string" jdbcType="VARCHAR" />
		<result property="subjectType" column="subject_type" javaType="string" jdbcType="VARCHAR" />
		<result property="promoteId" column="promote_id" javaType="long" jdbcType="BIGINT" />
		<result property="limitTimes" column="limit_times" javaType="int" jdbcType="INTEGER" />
		<result property="totalTimes" column="total_times" javaType="int" jdbcType="INTEGER" />
		<result property="startDate" column="start_date" javaType="date" jdbcType="TIMESTAMP" />
		<result property="endDate" column="end_date" javaType="date" jdbcType="TIMESTAMP" />
		<result property="createDate" column="create_date" javaType="date" jdbcType="TIMESTAMP" />
		<result property="updateDate" column="update_date" javaType="date" jdbcType="TIMESTAMP" />
		<result property="fileName" column="file_name" javaType="string" jdbcType="VARCHAR" />
		<result property="diskFileName" column="disk_file_name" javaType="string" jdbcType="VARCHAR" />
		<result property="rootPath" column="root_path" javaType="string" jdbcType="VARCHAR" />
		<result property="relativePath" column="relative_path" javaType="string" jdbcType="VARCHAR" />
		<result property="fileSize" column="file_size" javaType="long" jdbcType="BIGINT" />
		<result property="fileSuffix" column="file_suffix" javaType="string" jdbcType="VARCHAR" />
		<result property="description" column="description" javaType="string" jdbcType="VARCHAR" />
		<result property="subjectStatus" column="subject_status" javaType="int" jdbcType="INTEGER" />
		<result property="reserve1" column="reserve_1" javaType="string" jdbcType="VARCHAR" />
		<result property="reserve2" column="reserve_2" javaType="string" jdbcType="VARCHAR" />
		<result property="reserve3" column="reserve_3" javaType="string" jdbcType="VARCHAR" />
	</resultMap>
	
	
	

	<select id="get" parameterType="long"
		resultMap="sharehrefDaoMap">
		select * from tb_share_href where id = #{id}
	</select>

	<select id="getListByZoneCode" parameterType="hashmap"
		resultMap="sharehrefDaoMap">
		select * from
		tb_share_href
		where (zone_code = #{zoneCode} or unit_id = 1) and href_status = 0 order by ord desc
	</select>
	
	
	<select id="getVoteSubjectListByHrefId" parameterType="hashmap" resultMap="votesubjectDaoMap">
		SELECT
			vs.*
		FROM
			tb_vote_subject vs
		JOIN tb_share_href_data_rt rt ON vs.id = rt.data_id
		WHERE
			vs.subject_status = 0 
		and rt.href_id = #{hrefId}
		and rt.str_1 = 'vote'
		and now() BETWEEN vs.start_date AND vs.end_date
		order by rt.ord desc
	</select>

</mapper>