<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.h2y.os.dao.read.IZoneDaoR">

	<resultMap type="com.h2y.os.entity.Zone" id="zoneDaoMap">
		<result property="id" column="id" javaType="long" jdbcType="BIGINT" />
		<result property="code" column="code" javaType="string" jdbcType="VARCHAR" />
		<result property="name" column="name" javaType="string" jdbcType="VARCHAR" />
		<result property="pid" column="pid" javaType="string" jdbcType="VARCHAR" />
		<result property="pcode" column="pcode" javaType="string" jdbcType="VARCHAR" />
		<result property="preFix" column="pre_fix" javaType="string" jdbcType="VARCHAR" />
		<result property="level" column="level" javaType="string" jdbcType="VARCHAR" />
		<result property="isLast" column="is_last" javaType="string" jdbcType="VARCHAR" />
		<result property="longitude" column="longitude" javaType="double" jdbcType="DOUBLE" />
		<result property="latitude" column="latitude" javaType="double" jdbcType="DOUBLE" />
		<result property="location" column="location" javaType="string" jdbcType="VARCHAR" />
		<result property="spellName" column="spell_name" javaType="string" jdbcType="VARCHAR" />
		<result property="firSpellName" column="fir_spell_name" javaType="string" jdbcType="VARCHAR" />
	</resultMap>
	
	<resultMap type="java.util.Map" id="zoneDaoListMap">
		<result property="id" column="id" javaType="long" jdbcType="BIGINT" />
		<result property="code" column="code" javaType="string" jdbcType="VARCHAR" />
		<result property="name" column="name" javaType="string" jdbcType="VARCHAR" />
		<result property="pid" column="pid" javaType="string" jdbcType="VARCHAR" />
		<result property="pcode" column="pcode" javaType="string" jdbcType="VARCHAR" />
		<result property="preFix" column="pre_fix" javaType="string" jdbcType="VARCHAR" />
		<result property="level" column="level" javaType="string" jdbcType="VARCHAR" />
		<result property="isLast" column="is_last" javaType="string" jdbcType="VARCHAR" />
		<result property="longitude" column="longitude" javaType="double" jdbcType="DOUBLE" />
		<result property="latitude" column="latitude" javaType="double" jdbcType="DOUBLE" />
		<result property="location" column="location" javaType="string" jdbcType="VARCHAR" />
		<result property="spellName" column="spell_name" javaType="string" jdbcType="VARCHAR" />
		<result property="firSpellName" column="fir_spell_name" javaType="string" jdbcType="VARCHAR" />
	</resultMap>
	
	<select id="get" parameterType="long" resultMap="zoneDaoMap">
		SELECT * FROM tb_zone WHERE id = #{id}
	</select>
	
	<select id="getByZoneCode" parameterType="string" resultMap="zoneDaoMap">
		SELECT * FROM tb_zone WHERE code = #{code}
	</select>

	<select id="getListByName" parameterType="hashmap" resultMap="zoneDaoMap">
	    SELECT
			z.*
		FROM
			tb_sys_units su
		JOIN tb_zone z ON su.zone_code = z.`code`
		WHERE
			su.unit_status = 'pass'
		AND su.unit_type = 0
		AND su.stop_date > NOW()
		and z.`name` = #{zoneName}
	</select>
	
	<select id="getCheckZoneList" resultType="hashmap">
		SELECT
			z.*
		FROM
			tb_sys_units su
		JOIN tb_zone z ON su.zone_code = z.`code`
		WHERE
			su.unit_status = 'pass'
		AND su.unit_type = 0
		AND su.stop_date > NOW()
	</select>
	
	
	<select id="getZoneList" parameterType="long" resultMap="zoneDaoListMap">
		SELECT
			z.id,
			z.`code`,
			z.`name`,
			z.pid,
			z.pcode,
			z.`level`,
			z.is_last,
			z.location,
			z.longitude,
			z.latitude
		FROM
			tb_zone z
		where
			z.pcode = #{code}
	</select>
	
</mapper>